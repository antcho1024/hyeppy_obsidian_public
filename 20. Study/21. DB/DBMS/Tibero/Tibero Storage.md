---
sticker: emoji//1f619
---

막메모

논리 저장 구조 : 테이블 스페이스
물리 파일을 기반으로 존재함
데이터 파일을 계속 추가하면 계속 크기가 추가됨

물리 저장 구조 크게 3가지
- Control file
  아래 두개의 파일의 정보, 상태들을 저장
  프로세스가 이 컨트롤 파일안의 정보로 데이터 파일 을 인식함 여기 없는 정보는 프로세스가 인식할 수 없음
- Datafile
- redo Log File

스키마 오브젝트 : 테이블, 인덱스 
이런 애들이 사용하는거 : 논리 저장구조

Online Redo Log Files : 저장하고 주기적으로 지우고 쓰고 지우고 쓰고
-> 아카이브에 복사해서 저장 (사용자가 직접 지울 수는 있지만 티베로가 스스로 지우진 않음)


SEGMENT는 어댑터 같은 것

---

![[Storage-20240909140848870.webp]]

### 물리 저장 구조
*저장 구조 종류*
- (File System)운영체제 파일 시스템: 일반적인 파일 시스템 위에 데이터베이스 파일을 저장하는 구조.
- (File System)Tibero Active Storage (TAS): Tibero 전용 파일 시스템을 활용하는 구조.
- (Raw Device)RAW 장치: 포맷되지 않은 디스크에 데이터베이스 파일을 저장하여 빠른 I/O 성능을 제공하는 구조.
- (File System)클러스터 파일 시스템: 여러 서버가 데이터 파일을 공유할 수 있는 파일 시스템을 사용하는 구조.

*저장소는 어떤 구조로?*
![[Storage-20241107175311462.webp]]
#### Data files
데이터가 저장됨.
Tables & Indexes 들과 같은 Logical structure들이 물리적 저장됨.

*데이터 파일은 어느 영역?*
Tablespace > Datafile >  Seegment [[Tablespace]] 사진 참고!
- Datafile 쪼개서 여러개 Tablespace 걸치기 불가
- Seegment 여러개 datafile 걸치기 가능, 여러 tablespace 걸치기 불가
![[Storage-20241107184855319.webp]]

*테이블 스페이스* 
일반 테이블스페이스
- 용도: 테이블, 인덱스와 같은 영구적인 스키마 객체를 저장
- 특징:
    - 데이터베이스에 영구적으로 저장되며,<font color="#c0504d"> 데이터 파일에 의해 관리</font>됩니다.
    - <font color="#c0504d">데이터베이스가 종료되더라도 데이터는 유지되며, 영구적으로 저장된 데이터 파일에 기록됩니다</font>.

임시 테이블스페이스
- 용도: 특정 세션 또는 트랜잭션 동안<font color="#c0504d"> 임시 데이터를 저장</font>하는 데 사용됩니다. 예를 들어, 임시 테이블이나 정렬 및 해시 작업과 같은 일시적인 데이터 처리에 활용됨. <font color="#4f81bd">(메모리는 한정이 있는데 무지 많은 데이터를 다 올려둘 수 없으니까.. 약간 스왑 영역 스타일)</font>
- 특징:
    - 일시적인 데이터만 저장되며, 트랜잭션이 끝나거나 데이터베이스가 종료되면 데이터가 사라집니다.
    - 임시 테이블스페이스에 저장된 데이터는 NOLOGGING 모드로 설정되어 <font color="#c0504d">Redo 로그에 기록되지 않으므로 복구되지 않</font>습니다.

*데이터 파일 온라인 vs 오프라인*
상태 변경은 테이블스페이스 관리와 유지보수에 필수적.
데이터 파일 관리 및 유지보수 시 데이터 무결성을 보호하면서 작업 가능
- 온라인
	- 사용가능한 상태. 데이터베이스가 이 파일에 접근하여 읽기/쓰기 작업을 수행 가능
	- 모든 테이블스페이스의 데이터 파일이 기본적으로 온라인 상태로 운영
- 오프라인
	- 사용 불가능한 상태로, 데이터베이스가 이 파일에 접근 불가
	- 오프라인 상태 활용(유지보수 작업능)
		- 테이블스페이스 삭제:  MOUNT 모드에서 수행 가능
		- 테이블스페이스 오프라인: 테이블스페이스 자체를 오프라인으로 변경하면, 이 테이블스페이스에 포함된 모든 데이터 파일도 자동으로 오프라인 상태가 됨
		- 데이터 파일 이름/경로 변경: 데이터 파일의 이름이나 위치를 변경하려면 해당 테이블스페이스를 오프라인 상태로 설정한 후, 경로를 수정 가능

*데이터 파일의 구조*
![[Storage-20241107190730082.webp]]
**데이터 파일 헤더**
- 역할: 데이터 파일의 메타 정보가 저장되는 부분
- 포함내용:  데이터 사이즈 정보, 체크포인트, TSN, 데이터베이스에서 고유하게 식별하기위한 파일 절대번호, 테이블스페이스에서 데이터파일을 식별하기위한 파일 상대 번호 등 메타정보 
	- 체크포인트, TSN: 데이터베이스의 복구와 일관성을 유지하기 위한 정보

**사용공간**
- 실제 데이터가 저장되는 공간

**미사용 (예전에 사용되었으나, 현재 미사용)**
- 데이터의 변경 또는 삭제로 인해 <font color="#c0504d">더 이상 사용되지 않는 공간</font>
	- 데이터가 삭제되거나 업데이트될 때, 이전에 사용된 공간이 빈 공간으로 남게 됩니다. 이 공간은 나중에 재사용될 수 있지만, 크기가 작은 경우 조각난 상태로 남아 효율적인 공간 활용이 어려울 수 있음

**미사용(한번도사용한적없음)**
데이터 파일 생성 시 초기 할당된 여유 공간으로, 아직 사용되지 않은 공간


#### Redo Log files
복구를 위하여 Database에서 변경된 모든 것을 기록하는 파일.

*Multiplexed Redo Log Files (다중화된 Redo 로그 파일)*
Redo 로그 파일을 여러 개의 디스크에 분산 저장하여 장애 발생 시 데이터 손실을 방지하고 데이터베이스의 복구 가능성을 높이는 방식
<font color="#c0504d">동일한 내용을 가진 여러 Member를 여러 디스크에 분리해 저장</font>함
![[Storage-20241107191815453.webp]]



*Archived Redo Log Files*
Redo Log files의 복사본
- 역할: 백업과 복구, TSC 환경의 Standby DB 업데이트, 데이터 복제 솔루션을 위함.
  데이터 손실을 최소화하고 데이터베이스의 일관성을 유지하기 위해 주기적으로 생성되어 보관

#### Control files
Database의 물리적 구조와 상태를 기록하는 파일

*저장되는 정보: 기본정보, 복구에 필요한 정보*
- 이름과 고유 식별자(DBID)
- 데이터베이스 생성 시각 
- 데이터 파일 및 로그 파일 정보
- 온라인, 아카이브 Redo 로그 정보
	-  데이터베이스가 복구 작업을 수행할 때 필요한 정보를 제공
- 테이블스페이스 정보
- RMGR(Recovery Manager) 백업 정보

🐤TSC에서도 컨트롤 파일 중요하지..!